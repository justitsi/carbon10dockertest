{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nconst graphql_1 = require(\"graphql\");\n\nconst location_1 = require(\"graphql/language/location\");\n\nconst vscode_languageserver_1 = require(\"vscode-languageserver\");\n\nconst getDiagnostics_1 = require(\"@apollographql/graphql-language-service-interface/dist/getDiagnostics\");\n\nconst source_1 = require(\"./utilities/source\");\n\nclass GraphQLDocument {\n  constructor(source) {\n    this.source = source;\n    this.syntaxErrors = [];\n\n    try {\n      this.ast = graphql_1.parse(source);\n    } catch (error) {\n      if (maybeCommentedOut(source.body)) return;\n      const range = source_1.rangeInContainingDocument(source, getDiagnostics_1.getRange(error.locations[0], source.body));\n      this.syntaxErrors.push({\n        severity: vscode_languageserver_1.DiagnosticSeverity.Error,\n        message: error.message,\n        source: \"GraphQL: Syntax\",\n        range\n      });\n    }\n  }\n\n  containsPosition(position) {\n    if (position.line < this.source.locationOffset.line - 1) return false;\n    const end = source_1.positionFromSourceLocation(this.source, location_1.getLocation(this.source, this.source.body.length));\n    return position.line <= end.line;\n  }\n\n}\n\nexports.GraphQLDocument = GraphQLDocument;\n\nfunction extractGraphQLDocuments(document, tagName = \"gql\") {\n  switch (document.languageId) {\n    case \"graphql\":\n      return [new GraphQLDocument(new graphql_1.Source(document.getText(), document.uri))];\n\n    case \"javascript\":\n    case \"javascriptreact\":\n    case \"typescript\":\n    case \"typescriptreact\":\n    case \"vue\":\n      return extractGraphQLDocumentsFromJSTemplateLiterals(document, tagName);\n\n    case \"python\":\n      return extractGraphQLDocumentsFromPythonStrings(document, tagName);\n\n    case \"ruby\":\n      return extractGraphQLDocumentsFromRubyStrings(document, tagName);\n\n    case \"dart\":\n      return extractGraphQLDocumentsFromDartStrings(document, tagName);\n\n    case \"reason\":\n      return extractGraphQLDocumentsFromReasonStrings(document, tagName);\n\n    case \"elixir\":\n      return extractGraphQLDocumentsFromElixirStrings(document, tagName);\n\n    default:\n      return null;\n  }\n}\n\nexports.extractGraphQLDocuments = extractGraphQLDocuments;\n\nfunction extractGraphQLDocumentsFromJSTemplateLiterals(document, tagName) {\n  const text = document.getText();\n  const documents = [];\n  const regExp = new RegExp(`${tagName}\\\\s*\\`([\\\\s\\\\S]+?)\\``, \"gm\");\n  let result;\n\n  while ((result = regExp.exec(text)) !== null) {\n    const contents = replacePlaceholdersWithWhiteSpace(result[1]);\n    const position = document.positionAt(result.index + (tagName.length + 1));\n    const locationOffset = {\n      line: position.line + 1,\n      column: position.character + 1\n    };\n    const source = new graphql_1.Source(contents, document.uri, locationOffset);\n    documents.push(new GraphQLDocument(source));\n  }\n\n  if (documents.length < 1) return null;\n  return documents;\n}\n\nfunction extractGraphQLDocumentsFromPythonStrings(document, tagName) {\n  const text = document.getText();\n  const documents = [];\n  const regExp = new RegExp(`\\\\b(${tagName}\\\\s*\\\\(\\\\s*[bfru]*(\"(?:\"\")?|'(?:'')?))([\\\\s\\\\S]+?)\\\\2\\\\s*\\\\)`, \"gm\");\n  let result;\n\n  while ((result = regExp.exec(text)) !== null) {\n    const contents = replacePlaceholdersWithWhiteSpace(result[3]);\n    const position = document.positionAt(result.index + result[1].length);\n    const locationOffset = {\n      line: position.line + 1,\n      column: position.character + 1\n    };\n    const source = new graphql_1.Source(contents, document.uri, locationOffset);\n    documents.push(new GraphQLDocument(source));\n  }\n\n  if (documents.length < 1) return null;\n  return documents;\n}\n\nfunction extractGraphQLDocumentsFromRubyStrings(document, tagName) {\n  const text = document.getText();\n  const documents = [];\n  const regExp = new RegExp(`(<<-${tagName})([\\\\s\\\\S]+?)${tagName}`, \"gm\");\n  let result;\n\n  while ((result = regExp.exec(text)) !== null) {\n    const contents = replacePlaceholdersWithWhiteSpace(result[2]);\n    const position = document.positionAt(result.index + result[1].length);\n    const locationOffset = {\n      line: position.line + 1,\n      column: position.character + 1\n    };\n    const source = new graphql_1.Source(contents, document.uri, locationOffset);\n    documents.push(new GraphQLDocument(source));\n  }\n\n  if (documents.length < 1) return null;\n  return documents;\n}\n\nfunction extractGraphQLDocumentsFromDartStrings(document, tagName) {\n  const text = document.getText();\n  const documents = [];\n  const regExp = new RegExp(`\\\\b(${tagName}\\\\(\\\\s*r?(\"\"\"|'''))([\\\\s\\\\S]+?)\\\\2\\\\s*\\\\)`, \"gm\");\n  let result;\n\n  while ((result = regExp.exec(text)) !== null) {\n    const contents = replacePlaceholdersWithWhiteSpace(result[3]);\n    const position = document.positionAt(result.index + result[1].length);\n    const locationOffset = {\n      line: position.line + 1,\n      column: position.character + 1\n    };\n    const source = new graphql_1.Source(contents, document.uri, locationOffset);\n    documents.push(new GraphQLDocument(source));\n  }\n\n  if (documents.length < 1) return null;\n  return documents;\n}\n\nfunction extractGraphQLDocumentsFromReasonStrings(document, tagName) {\n  const text = document.getText();\n  const documents = [];\n  const reasonFileFilter = new RegExp(/(\\[%(graphql|relay\\.))/g);\n\n  if (!reasonFileFilter.test(text)) {\n    return documents;\n  }\n\n  const reasonRegexp = new RegExp(/(?<=\\[%(graphql|relay\\.\\w*)[\\s\\S]*{\\|)[.\\s\\S]+?(?=\\|})/gm);\n  let result;\n\n  while ((result = reasonRegexp.exec(text)) !== null) {\n    const contents = result[0];\n    const position = document.positionAt(result.index);\n    const locationOffset = {\n      line: position.line + 1,\n      column: position.character + 1\n    };\n    const source = new graphql_1.Source(contents, document.uri, locationOffset);\n    documents.push(new GraphQLDocument(source));\n  }\n\n  if (documents.length < 1) return null;\n  return documents;\n}\n\nfunction extractGraphQLDocumentsFromElixirStrings(document, tagName) {\n  const text = document.getText();\n  const documents = [];\n  const regExp = new RegExp(`\\\\b(${tagName}\\\\(\\\\s*r?(\"\"\"))([\\\\s\\\\S]+?)\\\\2\\\\s*\\\\)`, \"gm\");\n  let result;\n\n  while ((result = regExp.exec(text)) !== null) {\n    const contents = replacePlaceholdersWithWhiteSpace(result[3]);\n    const position = document.positionAt(result.index + result[1].length);\n    const locationOffset = {\n      line: position.line + 1,\n      column: position.character + 1\n    };\n    const source = new graphql_1.Source(contents, document.uri, locationOffset);\n    documents.push(new GraphQLDocument(source));\n  }\n\n  if (documents.length < 1) return null;\n  return documents;\n}\n\nfunction replacePlaceholdersWithWhiteSpace(content) {\n  return content.replace(/\\$\\{([\\s\\S]+?)\\}/gm, match => {\n    return Array(match.length).join(\" \");\n  });\n}\n\nfunction maybeCommentedOut(content) {\n  return content.indexOf(\"/*\") > -1 && content.indexOf(\"*/\") > -1 || content.split(\"//\").length > 1;\n}","map":{"version":3,"sources":["../src/document.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst graphql_1 = require(\"graphql\");\nconst location_1 = require(\"graphql/language/location\");\nconst vscode_languageserver_1 = require(\"vscode-languageserver\");\nconst getDiagnostics_1 = require(\"@apollographql/graphql-language-service-interface/dist/getDiagnostics\");\nconst source_1 = require(\"./utilities/source\");\nclass GraphQLDocument {\n    constructor(source) {\n        this.source = source;\n        this.syntaxErrors = [];\n        try {\n            this.ast = graphql_1.parse(source);\n        }\n        catch (error) {\n            if (maybeCommentedOut(source.body))\n                return;\n            const range = source_1.rangeInContainingDocument(source, getDiagnostics_1.getRange(error.locations[0], source.body));\n            this.syntaxErrors.push({\n                severity: vscode_languageserver_1.DiagnosticSeverity.Error,\n                message: error.message,\n                source: \"GraphQL: Syntax\",\n                range\n            });\n        }\n    }\n    containsPosition(position) {\n        if (position.line < this.source.locationOffset.line - 1)\n            return false;\n        const end = source_1.positionFromSourceLocation(this.source, location_1.getLocation(this.source, this.source.body.length));\n        return position.line <= end.line;\n    }\n}\nexports.GraphQLDocument = GraphQLDocument;\nfunction extractGraphQLDocuments(document, tagName = \"gql\") {\n    switch (document.languageId) {\n        case \"graphql\":\n            return [\n                new GraphQLDocument(new graphql_1.Source(document.getText(), document.uri))\n            ];\n        case \"javascript\":\n        case \"javascriptreact\":\n        case \"typescript\":\n        case \"typescriptreact\":\n        case \"vue\":\n            return extractGraphQLDocumentsFromJSTemplateLiterals(document, tagName);\n        case \"python\":\n            return extractGraphQLDocumentsFromPythonStrings(document, tagName);\n        case \"ruby\":\n            return extractGraphQLDocumentsFromRubyStrings(document, tagName);\n        case \"dart\":\n            return extractGraphQLDocumentsFromDartStrings(document, tagName);\n        case \"reason\":\n            return extractGraphQLDocumentsFromReasonStrings(document, tagName);\n        case \"elixir\":\n            return extractGraphQLDocumentsFromElixirStrings(document, tagName);\n        default:\n            return null;\n    }\n}\nexports.extractGraphQLDocuments = extractGraphQLDocuments;\nfunction extractGraphQLDocumentsFromJSTemplateLiterals(document, tagName) {\n    const text = document.getText();\n    const documents = [];\n    const regExp = new RegExp(`${tagName}\\\\s*\\`([\\\\s\\\\S]+?)\\``, \"gm\");\n    let result;\n    while ((result = regExp.exec(text)) !== null) {\n        const contents = replacePlaceholdersWithWhiteSpace(result[1]);\n        const position = document.positionAt(result.index + (tagName.length + 1));\n        const locationOffset = {\n            line: position.line + 1,\n            column: position.character + 1\n        };\n        const source = new graphql_1.Source(contents, document.uri, locationOffset);\n        documents.push(new GraphQLDocument(source));\n    }\n    if (documents.length < 1)\n        return null;\n    return documents;\n}\nfunction extractGraphQLDocumentsFromPythonStrings(document, tagName) {\n    const text = document.getText();\n    const documents = [];\n    const regExp = new RegExp(`\\\\b(${tagName}\\\\s*\\\\(\\\\s*[bfru]*(\"(?:\"\")?|'(?:'')?))([\\\\s\\\\S]+?)\\\\2\\\\s*\\\\)`, \"gm\");\n    let result;\n    while ((result = regExp.exec(text)) !== null) {\n        const contents = replacePlaceholdersWithWhiteSpace(result[3]);\n        const position = document.positionAt(result.index + result[1].length);\n        const locationOffset = {\n            line: position.line + 1,\n            column: position.character + 1\n        };\n        const source = new graphql_1.Source(contents, document.uri, locationOffset);\n        documents.push(new GraphQLDocument(source));\n    }\n    if (documents.length < 1)\n        return null;\n    return documents;\n}\nfunction extractGraphQLDocumentsFromRubyStrings(document, tagName) {\n    const text = document.getText();\n    const documents = [];\n    const regExp = new RegExp(`(<<-${tagName})([\\\\s\\\\S]+?)${tagName}`, \"gm\");\n    let result;\n    while ((result = regExp.exec(text)) !== null) {\n        const contents = replacePlaceholdersWithWhiteSpace(result[2]);\n        const position = document.positionAt(result.index + result[1].length);\n        const locationOffset = {\n            line: position.line + 1,\n            column: position.character + 1\n        };\n        const source = new graphql_1.Source(contents, document.uri, locationOffset);\n        documents.push(new GraphQLDocument(source));\n    }\n    if (documents.length < 1)\n        return null;\n    return documents;\n}\nfunction extractGraphQLDocumentsFromDartStrings(document, tagName) {\n    const text = document.getText();\n    const documents = [];\n    const regExp = new RegExp(`\\\\b(${tagName}\\\\(\\\\s*r?(\"\"\"|'''))([\\\\s\\\\S]+?)\\\\2\\\\s*\\\\)`, \"gm\");\n    let result;\n    while ((result = regExp.exec(text)) !== null) {\n        const contents = replacePlaceholdersWithWhiteSpace(result[3]);\n        const position = document.positionAt(result.index + result[1].length);\n        const locationOffset = {\n            line: position.line + 1,\n            column: position.character + 1\n        };\n        const source = new graphql_1.Source(contents, document.uri, locationOffset);\n        documents.push(new GraphQLDocument(source));\n    }\n    if (documents.length < 1)\n        return null;\n    return documents;\n}\nfunction extractGraphQLDocumentsFromReasonStrings(document, tagName) {\n    const text = document.getText();\n    const documents = [];\n    const reasonFileFilter = new RegExp(/(\\[%(graphql|relay\\.))/g);\n    if (!reasonFileFilter.test(text)) {\n        return documents;\n    }\n    const reasonRegexp = new RegExp(/(?<=\\[%(graphql|relay\\.\\w*)[\\s\\S]*{\\|)[.\\s\\S]+?(?=\\|})/gm);\n    let result;\n    while ((result = reasonRegexp.exec(text)) !== null) {\n        const contents = result[0];\n        const position = document.positionAt(result.index);\n        const locationOffset = {\n            line: position.line + 1,\n            column: position.character + 1\n        };\n        const source = new graphql_1.Source(contents, document.uri, locationOffset);\n        documents.push(new GraphQLDocument(source));\n    }\n    if (documents.length < 1)\n        return null;\n    return documents;\n}\nfunction extractGraphQLDocumentsFromElixirStrings(document, tagName) {\n    const text = document.getText();\n    const documents = [];\n    const regExp = new RegExp(`\\\\b(${tagName}\\\\(\\\\s*r?(\"\"\"))([\\\\s\\\\S]+?)\\\\2\\\\s*\\\\)`, \"gm\");\n    let result;\n    while ((result = regExp.exec(text)) !== null) {\n        const contents = replacePlaceholdersWithWhiteSpace(result[3]);\n        const position = document.positionAt(result.index + result[1].length);\n        const locationOffset = {\n            line: position.line + 1,\n            column: position.character + 1\n        };\n        const source = new graphql_1.Source(contents, document.uri, locationOffset);\n        documents.push(new GraphQLDocument(source));\n    }\n    if (documents.length < 1)\n        return null;\n    return documents;\n}\nfunction replacePlaceholdersWithWhiteSpace(content) {\n    return content.replace(/\\$\\{([\\s\\S]+?)\\}/gm, match => {\n        return Array(match.length).join(\" \");\n    });\n}\nfunction maybeCommentedOut(content) {\n    return ((content.indexOf(\"/*\") > -1 && content.indexOf(\"*/\") > -1) ||\n        content.split(\"//\").length > 1);\n}\n//# sourceMappingURL=document.js.map"]},"metadata":{},"sourceType":"script"}