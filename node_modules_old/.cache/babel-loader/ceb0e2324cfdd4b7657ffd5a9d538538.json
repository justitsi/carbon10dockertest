{"ast":null,"code":"'use strict';\n\nconst logUpdate = require('log-update');\n\nconst chalk = require('chalk');\n\nconst figures = require('figures');\n\nconst indentString = require('indent-string');\n\nconst cliTruncate = require('cli-truncate');\n\nconst stripAnsi = require('strip-ansi');\n\nconst utils = require('./lib/utils');\n\nconst renderHelper = (tasks, options, level) => {\n  level = level || 0;\n  let output = [];\n\n  for (const task of tasks) {\n    if (task.isEnabled()) {\n      const skipped = task.isSkipped() ? ` ${chalk.dim('[skipped]')}` : '';\n      output.push(indentString(` ${utils.getSymbol(task, options)} ${task.title}${skipped}`, level, '  '));\n\n      if ((task.isPending() || task.isSkipped() || task.hasFailed()) && utils.isDefined(task.output)) {\n        let data = task.output;\n\n        if (typeof data === 'string') {\n          data = stripAnsi(data.trim().split('\\n').filter(Boolean).pop());\n\n          if (data === '') {\n            data = undefined;\n          }\n        }\n\n        if (utils.isDefined(data)) {\n          const out = indentString(`${figures.arrowRight} ${data}`, level, '  ');\n          output.push(`   ${chalk.gray(cliTruncate(out, process.stdout.columns - 3))}`);\n        }\n      }\n\n      if ((task.isPending() || task.hasFailed() || options.collapse === false) && (task.hasFailed() || options.showSubtasks !== false) && task.subtasks.length > 0) {\n        output = output.concat(renderHelper(task.subtasks, options, level + 1));\n      }\n    }\n  }\n\n  return output.join('\\n');\n};\n\nconst render = (tasks, options) => {\n  logUpdate(renderHelper(tasks, options));\n};\n\nclass UpdateRenderer {\n  constructor(tasks, options) {\n    this._tasks = tasks;\n    this._options = Object.assign({\n      showSubtasks: true,\n      collapse: true,\n      clearOutput: false\n    }, options);\n  }\n\n  render() {\n    if (this._id) {\n      // Do not render if we are already rendering\n      return;\n    }\n\n    this._id = setInterval(() => {\n      render(this._tasks, this._options);\n    }, 100);\n  }\n\n  end(err) {\n    if (this._id) {\n      clearInterval(this._id);\n      this._id = undefined;\n    }\n\n    render(this._tasks, this._options);\n\n    if (this._options.clearOutput && err === undefined) {\n      logUpdate.clear();\n    } else {\n      logUpdate.done();\n    }\n  }\n\n}\n\nmodule.exports = UpdateRenderer;","map":{"version":3,"sources":["/Users/hristobelchev/test_projects/testing_react/react-box-app/box-app/node_modules/listr-update-renderer/index.js"],"names":["logUpdate","require","chalk","figures","indentString","cliTruncate","stripAnsi","utils","renderHelper","tasks","options","level","output","task","isEnabled","skipped","isSkipped","dim","push","getSymbol","title","isPending","hasFailed","isDefined","data","trim","split","filter","Boolean","pop","undefined","out","arrowRight","gray","process","stdout","columns","collapse","showSubtasks","subtasks","length","concat","join","render","UpdateRenderer","constructor","_tasks","_options","Object","assign","clearOutput","_id","setInterval","end","err","clearInterval","clear","done","module","exports"],"mappings":"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","sourcesContent":["'use strict';\nconst logUpdate = require('log-update');\nconst chalk = require('chalk');\nconst figures = require('figures');\nconst indentString = require('indent-string');\nconst cliTruncate = require('cli-truncate');\nconst stripAnsi = require('strip-ansi');\nconst utils = require('./lib/utils');\n\nconst renderHelper = (tasks, options, level) => {\n\tlevel = level || 0;\n\n\tlet output = [];\n\n\tfor (const task of tasks) {\n\t\tif (task.isEnabled()) {\n\t\t\tconst skipped = task.isSkipped() ? ` ${chalk.dim('[skipped]')}` : '';\n\n\t\t\toutput.push(indentString(` ${utils.getSymbol(task, options)} ${task.title}${skipped}`, level, '  '));\n\n\t\t\tif ((task.isPending() || task.isSkipped() || task.hasFailed()) && utils.isDefined(task.output)) {\n\t\t\t\tlet data = task.output;\n\n\t\t\t\tif (typeof data === 'string') {\n\t\t\t\t\tdata = stripAnsi(data.trim().split('\\n').filter(Boolean).pop());\n\n\t\t\t\t\tif (data === '') {\n\t\t\t\t\t\tdata = undefined;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (utils.isDefined(data)) {\n\t\t\t\t\tconst out = indentString(`${figures.arrowRight} ${data}`, level, '  ');\n\t\t\t\t\toutput.push(`   ${chalk.gray(cliTruncate(out, process.stdout.columns - 3))}`);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif ((task.isPending() || task.hasFailed() || options.collapse === false) && (task.hasFailed() || options.showSubtasks !== false) && task.subtasks.length > 0) {\n\t\t\t\toutput = output.concat(renderHelper(task.subtasks, options, level + 1));\n\t\t\t}\n\t\t}\n\t}\n\n\treturn output.join('\\n');\n};\n\nconst render = (tasks, options) => {\n\tlogUpdate(renderHelper(tasks, options));\n};\n\nclass UpdateRenderer {\n\tconstructor(tasks, options) {\n\t\tthis._tasks = tasks;\n\t\tthis._options = Object.assign({\n\t\t\tshowSubtasks: true,\n\t\t\tcollapse: true,\n\t\t\tclearOutput: false\n\t\t}, options);\n\t}\n\n\trender() {\n\t\tif (this._id) {\n\t\t\t// Do not render if we are already rendering\n\t\t\treturn;\n\t\t}\n\n\t\tthis._id = setInterval(() => {\n\t\t\trender(this._tasks, this._options);\n\t\t}, 100);\n\t}\n\n\tend(err) {\n\t\tif (this._id) {\n\t\t\tclearInterval(this._id);\n\t\t\tthis._id = undefined;\n\t\t}\n\n\t\trender(this._tasks, this._options);\n\n\t\tif (this._options.clearOutput && err === undefined) {\n\t\t\tlogUpdate.clear();\n\t\t} else {\n\t\t\tlogUpdate.done();\n\t\t}\n\t}\n}\n\nmodule.exports = UpdateRenderer;\n"]},"metadata":{},"sourceType":"script"}